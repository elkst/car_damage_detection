<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –∞–≤—Ç–æ–º–æ–±–∏–ª—è</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>–î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –∞–≤—Ç–æ–º–æ–±–∏–ª—è</h1>
            <p>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ 14 —Ç–∏–ø–æ–≤ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –∫—É–∑–æ–≤–∞ –∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∞–≤—Ç–æ</p>
        </header>

        <main class="main-content">
            <!-- –§–æ—Ä–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ -->
            <div class="card upload-card">
                <h2>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è</h2>
                <form action="/detect/" method="post" enctype="multipart/form-data" class="upload-form">
                    <div class="upload-area">
                        <input type="file" id="fileInput" name="file" accept="image/*" required>
                        <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</p>
                        <p class="upload-sub">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: JPG, PNG, JPEG</p>
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" name="show_area" value="true">
                            –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–ª–æ—â–∞–¥—å –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏
                        </label>
                    </div>

                    <button type="submit" class="analyze-btn">
                        –ù–∞—á–∞—Ç—å –∞–Ω–∞–ª–∏–∑
                    </button>
                </form>

                <div class="classes-info">
                    <h3>–°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–∏—Ç 14 —Ç–∏–ø–æ–≤ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π:</h3>
                    <ul>
                        {% for class_name, russian_name in russian_names.items() %}
                        <li>{{ russian_name }} ({{ class_name }})</li>
                        {% endfor %}
                    </ul>
                </div>

                <div class="api-info">
                    <h3>API –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:</h3>
                    <p><strong>POST</strong> /api/v1/detect - –¥–µ—Ç–µ–∫—Ü–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π</p>
                    <p><strong>GET</strong> /api/v1/classes - —Å–ø–∏—Å–æ–∫ –∫–ª–∞—Å—Å–æ–≤</p>
                    <p><strong>GET</strong> /api/v1/health - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è</p>
                </div>
            </div>

            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
            <div class="card results-card">
                <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞</h2>

                {% if result %}
                    {% if result.success %}
                        <div class="results-success">
                            <h3>‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!</h3>

                            <div class="severity-badge {{ result.statistics.damage_severity|lower|replace(' ', '-') }}">
                                <span class="severity-text">–£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π: {{ result.statistics.damage_severity }}</span>
                            </div>

                            <div class="image-comparison">
                                <div class="image-box">
                                    <p>–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:</p>
                                    <img src="{{ result.upload_path }}" alt="–û—Ä–∏–≥–∏–Ω–∞–ª">
                                </div>
                                <div class="image-box">
                                    <p>–†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è:</p>
                                    <img src="{{ result.result_path }}" alt="–†–µ–∑—É–ª—å—Ç–∞—Ç">
                                </div>
                            </div>

                            <!-- –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                            <div class="stats-section">
                                <h3>üìä –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</h3>
                                <div class="stats">
                                    <div class="stat-item">
                                        <div class="stat-value">{{ result.statistics.total_detections }}</div>
                                        <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">{{ result.statistics.damage_types_found }}</div>
                                        <div class="stat-label">–¢–∏–ø–æ–≤ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π</div>
                                    </div>
                                    <div class="stat-item">
                                        <div class="stat-value">{{ result.statistics.damage_percentage }}%</div>
                                        <div class="stat-label">–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω–∞—è –ø–ª–æ—â–∞–¥—å</div>
                                    </div>
                                </div>
                            </div>

                            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–æ—â–∞–¥–∏ -->
                            <div class="area-stats">
                                <h3>üìê –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–æ—â–∞–¥–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π:</h3>
                                <div class="area-grid">
                                    <div class="area-item">
                                        <div class="area-label">–û–±—â–∞—è –ø–ª–æ—â–∞–¥—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</div>
                                        <div class="area-value">{{ result.statistics.image_area_formatted }}</div>
                                    </div>
                                    <div class="area-item">
                                        <div class="area-label">–û–±—â–∞—è –ø–ª–æ—â–∞–¥—å –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π:</div>
                                        <div class="area-value">{{ result.statistics.total_damage_area_formatted }}</div>
                                    </div>
                                    <div class="area-item">
                                        <div class="area-label">–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω–æ–π –ø–ª–æ—â–∞–¥–∏:</div>
                                        <div class="area-value">{{ result.statistics.damage_percentage }}%</div>
                                    </div>
                                    <div class="area-item">
                                        <div class="area-label">–°—Ä–µ–¥–Ω—è—è –ø–ª–æ—â–∞–¥—å –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è:</div>
                                        <div class="area-value">{{ result.statistics.avg_damage_area_formatted }}</div>
                                    </div>
                                    {% if result.statistics.max_damage %}
                                    <div class="area-item">
                                        <div class="area-label">–°–∞–º–æ–µ –±–æ–ª—å—à–æ–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ:</div>
                                        <div class="area-value">{{ result.statistics.max_damage.area_formatted }} ({{ result.statistics.max_damage.class }})</div>
                                    </div>
                                    {% endif %}
                                    {% if result.statistics.min_damage %}
                                    <div class="area-item">
                                        <div class="area-label">–°–∞–º–æ–µ –º–∞–ª–µ–Ω—å–∫–æ–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ:</div>
                                        <div class="area-value">{{ result.statistics.min_damage.area_formatted }} ({{ result.statistics.min_damage.class }})</div>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è -->
                            <h3>üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è:</h3>
                            <div class="detections-list">
                                {% if result.detections %}
                                    {% for det in result.detections %}
                                    <div class="detection-item">
                                        <div class="detection-header">
                                            <div class="detection-class">
                                                <strong>{{ det.russian_name }}</strong>
                                            </div>
                                            <div class="detection-confidence">
                                                –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {{ det.confidence_percent }}%
                                            </div>
                                        </div>
                                        <div class="detection-details">
                                            <div class="detection-coords">
                                                –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: [{{ det.bbox[0] }}, {{ det.bbox[1] }}] - [{{ det.bbox[2] }}, {{ det.bbox[3] }}]
                                            </div>
                                            <div class="detection-size">
                                                –†–∞–∑–º–µ—Ä: {{ det.width }}√ó{{ det.height }}px
                                            </div>
                                            <div class="detection-area">
                                                –ü–ª–æ—â–∞–¥—å: {{ det.area_formatted }} ({{ det.area_percentage }}% –æ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                {% else %}
                                    <p>–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ</p>
                                {% endif %}
                            </div>

                            <!-- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–ª–∞—Å—Å–∞–º -->
                            {% if result.statistics.class_counts %}
                            <h3>üìà –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–ª–∞—Å—Å–∞–º:</h3>
                            <div class="class-distribution">
                                {% for class_name, count in result.statistics.class_counts.items() %}
                                <div class="class-item">
                                    <div class="class-info">
                                        <span class="class-name">
                                            {% if class_name in russian_names %}
                                                {{ russian_names[class_name] }}
                                            {% else %}
                                                {{ class_name }}
                                            {% endif %}
                                        </span>
                                        <span class="class-count">{{ count }} –æ–±–Ω–∞—Ä—É–∂.</span>
                                    </div>
                                    <div class="class-bar">
                                        <div class="class-bar-fill" style="width: {{ (count / result.statistics.total_detections * 100)|round(1) }}%"></div>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                    {% else %}
                        <div class="results-error">
                            <h3>‚ùå –û—à–∏–±–∫–∞!</h3>
                            <p>{{ result.error }}</p>
                        </div>
                    {% endif %}
                {% else %}
                    <div class="results-placeholder">
                        <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.</p>
                        <p>–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–¥–µ—Å—å.</p>
                    </div>
                {% endif %}
            </div>
        </main>

        <footer class="footer">
            <p>Car Damage Detector API v2.0 | 14 –∫–ª–∞—Å—Å–æ–≤ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–æ—â–∞–¥–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π</p>
            <p class="timestamp">{% if result and result.success %}–ü–æ—Å–ª–µ–¥–Ω–∏–π –∞–Ω–∞–ª–∏–∑: {{ result.statistics.detection_time }}{% endif %}</p>
        </footer>
    </div>
</body>
</html>